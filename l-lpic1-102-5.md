# Learn linux, 101, RPM和YUM软件包管理

标签（空格分隔）： lpi-pre-exam 翻译
---

## 概览
在本教程中，学习使用RPM和YUM工具来管理Linux系统上的软件包。 学会：

- 使用RPM和YUM安装，重新安装，升级和删除软件包。
- 获取有关RPM软件包的信息，包括版本，状态，依赖项，完整性和签名。
- 确定程序包提供的文件，以及查找特定文件来自哪个程序包。

本教程可帮助您为Linux Professional Institute的初级管理（LPIC-1）考试101的主题102中的目标102.5做准备。目标的权重为3。

## 包管理简介
过去，许多Linux程序作为源代码分发，用户可以将其构建到所需的程序或程序集中，以及所需的手册页，配置文件等。 如今，大多数Linux发行商使用预先构建的程序或称为程序包的程序集，这些程序可以在该发行版上安装。 在本教程中，您将了解可帮助您安装，更新和删除软件包的软件包管理工具。 本教程重点介绍由Red Hat开发的Red Hat Package Manager（RPM）以及最初为在杜克大学物理系管理Red Hat Linux系统而开发的Yellowdog Updater Modified（YUM）。 本系列的另一个教程“学习Linux 101：Debian包管理”涵盖了Debian系统上使用的包管理工具。
从用户的角度来看，基本包管理功能由命令提供。 随着Linux开发人员努力使Linux更易于使用，基本工具已经被其他工具（包括GUI工具）所补充，这些工具隐藏了最终用户的基本工具的一些复杂性。 在本教程和Debian软件包管理教程中，我们专注于基本工具，尽管我们提到了一些其他工具，因此您可以进一步研究它们。

### 前置调教
要从本系列教程中获得最大收益，您应该具备Linux的基本知识和可以在其上练习本教程中涵盖的命令的Linux系统。 有时程序的不同版本会以不同的方式格式化输出，因此您的结果可能并不总是与此处显示的列表和图形完全相同。 特别是，我们展示的大部分输出高度依赖于我们系统上已安装的软件包。 虽然您应该能够识别重要的共性，但您自己的输出可能会大不相同。 除非另有说明，否则本教程中的示例使用Fedora 20系统。

## 包管理
RPM，YUM和APT（对于Debian系统）有许多相似之处。 所有人都可以安装和删除包。 有关已安装软件包的信息保存在数据库中。 它们都具有基本的命令行功能，而其他工具可以提供更加用户友好的界面。 所有人都可以从互联网上检索包裹。

安装Linux系统时，通常会安装大量软件包。 该集合可以根据系统的预期用途进行定制，例如服务器，桌面或开发者工作站。 在某些时候，您可能需要安装新软件包以增加功能，更新您拥有的软件包，甚至删除不再需要或已被新软件包淘汰的软件包。 让我们看看你是如何完成这些任务的，以及一些相关的挑战，例如找到哪个包可能包含特定的命令。

### RPM
Red Hat于1995年推出了RPM.RPM现在是用于Linux标准库（LSB）打包的包管理系统。 rpm命令选项分为三个子组：

- 请求和验证软件包
- 安装、升级和卸载软件包
- 执行其他功能

我们将重点介绍本教程中的前两组命令选项。 您可以在RPM的手册页中找到有关其他功能的信息。

我们还应该注意，rpm是RPM使用的主命令的命令名，而.rpm是RPM文件的扩展名。 所以“rpm”或“xxx rpm”通常是指RPM文件，而rpm通常是指命令。

### YUM
YUM向RPM系统添加了自动更新和包管理，包括依赖关系管理。 除了理解系统上已安装的软件包之外，YUM与Debian高级打包工具（APT）类似，它与存储库一起使用，存储库是软件包的集合，通常可通过网络连接访问。

## 安装RPM软件包
假设您要编译Fortran程序，并且同事告诉您使用gfortran命令。 您可以尝试gfortran --help，或者您可以尝试使用gfortran或输入gfortran。 但是如果你的系统找不到gfortran，你可能会看到类似于中所示的输出。

```bash
[ian@attic-f21 ~]$ gfortran --help</strong>
bash: gfortran: command not found
 
[ian@attic-f21 ~]$ gfortran --help</strong>
bash: gfortran: command not found...
Install package 'gcc-gfortran' to provide command 'gfortran'? [N/y] n</strong>
 
 
[ian@attic-f21 ~]$ which gfortran</strong>
/usr/bin/which: no gfortran in (/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:
/home/ian/.local/bin:/home/ian/bin)
 
[ian@attic-f21 ~]$ type gfortran</strong>
bash: type: gfortran: not found
```

如果您没有从第二种输出形式中获得有用的建议，您可以与您的同事核实，以找出要安装的软件包。 否则，您可能只是猜测gfortran命令位于gfortran包中。 这通常是一个很好的猜测，但并不总是正确的，在这种情况下不是正确的。 我们稍后会看到如何找到合适的包装。 假设您知道它确实在gcc-gfortran包中并且您下载或以其他方式获得了包的副本，您可以尝试使用带有-i（用于安装）选项的rpm命令来安装它，如图所示。
```bash
[root@attic-f21 ~]# rpm -i  gcc-gfortran-4.9.2-6.fc21.x86_64.rpm </strong>
error: Failed dependencies:
    libquadmath-devel = 4.9.2-6.fc21 is needed by gcc-gfortran-4.9.2-6.fc21.x86_64
```
rpm命令知道包具有依赖关系，但遗憾的是，它无法帮助您解决该依赖关系。您将需要获取依赖包或包，再试一次，并查看是否存在其他依赖关系 - 并继续执行此操作直到满足所有依赖关系。一个好处是你可以给rpm命令一个要安装的软件包列表，如果满足所有依赖项，它将以正确的顺序安装它们。所以你至少不必按正确的顺序手动安装每一件。

如果你已经使用过Debian的APT，那么你可能希望你有类似apt-get命令的东西，它会简单地找到你需要的东西，包括依赖项，然后安装它。对于基于RPM的系统，YUM（或Yellowdog Updater Modified）提供了这样的功能。显示如何使用带有install选项的yum命令安装gcc-gfortran和必需的先决条件。注意：您的依赖项可能会根据您在系统上安装的内容而有所不同。
```bash
[root@attic-f21 ~]# yum install gcc-gfortran</strong>
Loaded plugins: langpacks
Resolving Dependencies
--> Running transaction check
---> Package gcc-gfortran.x86_64 0:4.9.2-6.fc21 will be installed
--> Processing Dependency: libquadmath-devel = 4.9.2-6.fc21 for package: gcc-gfortran-4.9.2-6.fc21.x86_64
--> Running transaction check
---> Package libquadmath-devel.x86_64 0:4.9.2-6.fc21 will be installed
--> Finished Dependency Resolution
 
Dependencies Resolved
 
================================================================================
 Package                 Arch         Version               Repository     Size
================================================================================
Installing:
 gcc-gfortran            x86_64       4.9.2-6.fc21          updates       7.7 M
Installing for dependencies:
 libquadmath-devel       x86_64       4.9.2-6.fc21          updates        37 k
 
Transaction Summary
================================================================================
Install  1 Package (+1 Dependent package)
 
Total download size: 7.7 M
Installed size: 18 M
Is this ok [y/d/N]: y</strong>
Downloading packages:
(1/2): libquadmath-devel-4.9.2-6.fc21.x86_64.rpm            |  37 kB  00:00     
(2/2): gcc-gfortran-4.9.2-6.fc21.x86_64.rpm                 | 7.7 MB  00:04     
--------------------------------------------------------------------------------
Total                                              1.6 MB/s | 7.7 MB  00:04     
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction (shutdown inhibited)
  Installing : libquadmath-devel-4.9.2-6.fc21.x86_64                        1/2 
  Installing : gcc-gfortran-4.9.2-6.fc21.x86_64                             2/2 
  Verifying  : libquadmath-devel-4.9.2-6.fc21.x86_64                        1/2 
  Verifying  : gcc-gfortran-4.9.2-6.fc21.x86_64                             2/2 
 
Installed:
  gcc-gfortran.x86_64 0:4.9.2-6.fc21                                            
 
Dependency Installed:
  libquadmath-devel.x86_64 0:4.9.2-6.fc21                                       
 
Complete!
```
输出显示YUM在名为“updates”的存储库中找到了x86_64版本的gcc-gfortran和libquadmath-devel（稍后会详细介绍），并确定总下载大小。 在回答“y”同意该事务后，它下载了两个软件包，然后安装了依赖项，然后是gcc-gfortran。 您将在本教程后面了解有关依赖项的更多信息。

注意：在，YUM找到了最新版本的gcc-gfortran软件包，它碰巧与我们试图安装的软件包的级别（4.9.2-6）相同。 您通常需要最新版本的软件包，但如果需要早期版本或i686版本而不是x86_64版本，则可以提供其他资格。 请参阅yum命令的手册页中有关指定包名称的部分。

## 软件包的位置
在上一节中，您学习了如何安装RPM包。但是这些包裹来自哪里？ yum如何知道从哪里下载包？起点是/etc/yum.repos.d/目录，它通常包含几个repo文件。这是存储库信息的默认位置，但可以在YUM配置文件中指定其他位置，通常是/etc/yum.conf。显示了Fedora-updates.repo，它对应于我们在Fedora 21系统上安装gcc-gfortran的位置。

典型的repo文件分为三个部分，一个用于普通包，一个用于调试包，最后一个用于源包。通常，将有来自不同位置或镜像的分发包的多个副本。所以repo文件告诉yum在哪里可以找到每个部分的最新镜像列表。请注意，分发版本级别和机器架构是参数化的，因此yum会从https://mirrors.fedoraproject.org/metalink?repo=updates-released-f21&arch=x86_64下载我的x86_64 Fedora 21系统的列表。

除了存储库位置之外，repo文件还会告知是否启用了特定存储库以及是否应使用GPG签名来检查下载的包。
```bash
[ian@attic-f21 ~]$ cat /etc/yum.repos.d/fedora-updates.repo</strong>
[updates]
name=Fedora $releasever - $basearch - Updates
failovermethod=priority
#baseurl=http://download.fedoraproject.org/pub/fedora/linux/updates/$releasever/$basearch/
metalink=https://mirrors.fedoraproject.org/metalink?repo=updates-released-f$releasever&arch=$
basearch
enabled=1
metadata_expire=6h
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch
skip_if_unavailable=False
 
[updates-debuginfo]
name=Fedora $releasever - $basearch - Updates - Debug
failovermethod=priority
#baseurl=http://download.fedoraproject.org/pub/fedora/linux/updates/$releasever/$basearch/debug/
metalink=https://mirrors.fedoraproject.org/metalink?repo=updates-released-debug-f$releasever&
arch=$basearch
enabled=0
gpgcheck=1
metadata_expire=6h
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch
skip_if_unavailable=False
 
[updates-source]
name=Fedora $releasever - Updates Source
failovermethod=priority
#baseurl=http://download.fedoraproject.org/pub/fedora/linux/updates/$releasever/SRPMS/
metalink=https://mirrors.fedoraproject.org/metalink?repo=updates-released-source-f$releasever&
arch=$basearch
enabled=0
gpgcheck=1
metadata_expire=6h
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch
skip_if_unavailable=False
```
YUM和RPM使用本地数据库来确定安装了哪些软件包。 从启用的存储库中检索存储在本地数据库中的包的元数据。 虽然您很少需要担心本地数据库，但您可以使用命令yum clean清除本地存储信息的各个部分，并使用yum makecache在本地数据库中为已启用的存储库创建信息。 例如，如果更改repo配置，则可以执行此操作。

## 删除RPM软件包
如果要删除包，可以使用yum的remove选项或rpm的-e选项。 使用rpm -e去除gcc-gfortran的测试运行如下所示。 如果可以删除包，则没有输出。
```bash
[root@attic-f21 ~]# rpm -e --test gcc-gfortran</strong>
[
```
与使用apt-get模拟删除Debian软件包不同，RPM系统不会维护有关自动添加的软件包的信息，因此没有简单的方法可以找出哪些依赖项也可能被删除。 但是，如果在单个命令上指定要删除的多个程序包，则在具有依赖项的程序包之前将删除没有依赖项的程序包。

使用rpm删除软件包时，在删除软件包之前没有提示，这与安装软件包时不同。 但是，如果您尝试删除某些其他程序包所需的程序包，则不会执行该操作，并且会收到错误消息，如图所示。
```bash
[root@attic-f21 ~]# rpm -e libquadmath-devel</strong>
error: Failed dependencies:
    libquadmath-devel = 4.9.2-6.fc21 is needed by (installed) gcc-gfortran-4.9.2-6.fc21.x86_64
```
如果您使用yum remove，则会在执行事务测试后提示您。 如果您要删除的包是某些其他已安装包的依赖包，那么YUM将提供删除它们以及依赖包，如下所示。
```bash
[root@attic-f21 ~]# yum remove libquadmath-devel</strong>
Loaded plugins: langpacks
Resolving Dependencies
--> Running transaction check
---> Package libquadmath-devel.x86_64 0:4.9.2-6.fc21 will be erased
--> Processing Dependency: libquadmath-devel = 4.9.2-6.fc21 for package: gcc-gfortran-4.9.2-6.fc21.x86_64
--> Running transaction check
---> Package gcc-gfortran.x86_64 0:4.9.2-6.fc21 will be erased
--> Finished Dependency Resolution
 
Dependencies Resolved
 
================================================================================
 Package                 Arch         Version              Repository      Size
================================================================================
Removing:
 libquadmath-devel       x86_64       4.9.2-6.fc21         @updates        18 k
Removing for dependencies:
 gcc-gfortran            x86_64       4.9.2-6.fc21         @updates        18 M
 
Transaction Summary
================================================================================
Remove  1 Package (+1 Dependent package)
 
Installed size: 18 M
Is this ok [y/N]: n</strong>
Exiting on user command
Your transaction was saved, rerun it with:
 yum load-transaction /tmp/yum_save_tx.2015-07-27.22-01.amzaZh.yumtx
```

## 升级RPM软件包
既然您已经知道如何安装和删除RPM，那么让我们看看将RPM包升级到更新的级别。 您可以使用yum update更新整个系统，也可以指定单个包或通配符规范。 显示如何更新名称以“pop”开头的所有包。 注意使用撇号来防止shell扩展“*”。
```bash
[root@attic-f21 ~]# yum update 'pop*'
Loaded plugins: langpacks
Resolving Dependencies
--> Running transaction check
---> Package poppler.x86_64 0:0.26.2-3.fc21 will be updated
---> Package poppler.x86_64 0:0.26.2-9.fc21 will be an update
---> Package poppler-data.noarch 0:0.4.7-1.fc21 will be updated
---> Package poppler-data.noarch 0:0.4.7-2.fc21 will be an update
---> Package poppler-glib.x86_64 0:0.26.2-3.fc21 will be updated
---> Package poppler-glib.x86_64 0:0.26.2-9.fc21 will be an update
---> Package poppler-utils.x86_64 0:0.26.2-3.fc21 will be updated
---> Package poppler-utils.x86_64 0:0.26.2-9.fc21 will be an update
--> Finished Dependency Resolution
 
Dependencies Resolved
 
==========================================================================
 Package             Arch         Version             Repository     Size
==========================================================================
Updating:
 poppler             x86_64       0.26.2-9.fc21       updates       798 k
 poppler-data        noarch       0.4.7-2.fc21        updates       2.2 M
 poppler-glib        x86_64       0.26.2-9.fc21       updates       141 k
 poppler-utils       x86_64       0.26.2-9.fc21       updates       171 k
 
Transaction Summary
==========================================================================
Upgrade  4 Packages
 
Total download size: 3.2 M
Is this ok [y/d/N]: y
Downloading packages:
Delta RPMs reduced 3.1 M of updates to 315 k (89% saved)
(1/4): poppler-data-0.4.7-1.fc21_0.4.7-2.fc21.noarch. |  70 kB  00:00     
(2/4): poppler-0.26.2-3.fc21_0.26.2-9.fc21.x86_64.drp | 208 kB  00:00     
(3/4): poppler-glib-0.26.2-3.fc21_0.26.2-9.fc21.x86_6 |  36 kB  00:00     
(4/4): poppler-utils-0.26.2-9.fc21.x86_64.rpm         | 171 kB  00:00     
Finishing delta rebuilds of 3 package(s) (3.1 M)
--------------------------------------------------------------------------
Total                                        142 kB/s | 486 kB  00:03     
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction (shutdown inhibited)
  Updating   : poppler-data-0.4.7-2.fc21.noarch                       1/8 
  Updating   : poppler-0.26.2-9.fc21.x86_64                           2/8 
  Updating   : poppler-glib-0.26.2-9.fc21.x86_64                      3/8 
  Updating   : poppler-utils-0.26.2-9.fc21.x86_64                     4/8 
  Cleanup    : poppler-utils-0.26.2-3.fc21.x86_64                     5/8 
  Cleanup    : poppler-glib-0.26.2-3.fc21.x86_64                      6/8 
  Cleanup    : poppler-0.26.2-3.fc21.x86_64                           7/8 
  Cleanup    : poppler-data-0.4.7-1.fc21.noarch                       8/8 
  Verifying  : poppler-data-0.4.7-2.fc21.noarch                       1/8 
  Verifying  : poppler-glib-0.26.2-9.fc21.x86_64                      2/8 
  Verifying  : poppler-0.26.2-9.fc21.x86_64                           3/8 
  Verifying  : poppler-utils-0.26.2-9.fc21.x86_64                     4/8 
  Verifying  : poppler-data-0.4.7-1.fc21.noarch                       5/8 
  Verifying  : poppler-utils-0.26.2-3.fc21.x86_64                     6/8 
  Verifying  : poppler-glib-0.26.2-3.fc21.x86_64                      7/8 
  Verifying  : poppler-0.26.2-3.fc21.x86_64                           8/8 
 
Updated:
  poppler.x86_64 0:0.26.2-9.fc21                                          
  poppler-data.noarch 0:0.4.7-2.fc21                                      
  poppler-glib.x86_64 0:0.26.2-9.fc21                                     
  poppler-utils.x86_64 0:0.26.2-9.fc21                                    
 
Complete!
```
如果您知道RPM文件的位置或已下载它们，您还可以使用rpm命令更新它们。 这与安装类似，不同之处在于您使用-U或-F选项而不是-i选项。 这两个选项之间的区别在于-U选项将升级现有软件包或安装软件包（如果尚未安装），而-F选项仅升级或刷新已安装的软件包。 因此，经常使用-U选项，尤其是当命令行包含RPM列表时。 这样，安装了已卸载的软件包，同时升级了已安装的软件包。 另外两个选项-v（详细）和-h（哈希标记）通常用于提供进度指示。 演示如何使用rpm命令更新cairo包及其cairo-gobject依赖项。 我们已经在root的主目录中下载了cairo rpm，而我们从其中一个更新镜像中检索了cairo-gobject包。

## 查询RPM包
在我们的示例中，您看到使用rpm命令安装rpm需要包文件（或URL）的全名，例如gcc-gfortran-4.9.2-6.fc21.x86_64.rpm。 另一方面，使用yum安装或使用任一命令删除rpm只需要包名称，例如gcc-gfortran。 与APT一样，RPM维护已安装软件包的内部数据库，允许您使用软件包名称操作已安装的软件包。 在本节中，我们将使用rpm命令的-q（用于查询）选项或关联的yum查询来查看此数据库中可用的一些信息。

我们将重新安装gcc-gfortran包以提供我们的示例。

基本查询只询问是否安装了软件包，如果是，则安装什么版本。 添加-i选项，您将获得有关该包的信息。 请注意，您需要具有root权限才能安装，升级或删除软件包，但非root用户可以对rpm数据库执行查询。
```bash
[ian@attic-f21 ~]$ yum list gcc-gfortran</strong>
Loaded plugins: langpacks
Installed Packages
gcc-gfortran.x86_64                    4.9.2-6.fc21                     @updates
Available Packages
gcc-gfortran.i686                      4.9.2-6.fc21                     updates 
 
[ian@attic-f21 ~]$ rpm -q gcc-gfortran</strong>
gcc-gfortran-4.9.2-6.fc21.x86_64
 
[ian@attic-f21 ~]$ yum info gcc-gfortran</strong>
Loaded plugins: langpacks
Installed Packages
Name        : gcc-gfortran
Arch        : x86_64
Version     : 4.9.2
Release     : 6.fc21
Size        : 18 M
Repo        : installed
From repo   : updates
Summary     : Fortran support
URL         : http://gcc.gnu.org
License     : GPLv3+ and GPLv3+ with exceptions and GPLv2+ with exceptions and
            : LGPLv2+ and BSD
Description : The gcc-gfortran package provides support for compiling Fortran
            : programs with the GNU Compiler Collection.
 
Available Packages
Name        : gcc-gfortran
Arch        : i686
Version     : 4.9.2
Release     : 6.fc21
Size        : 7.5 M
Repo        : updates/21/x86_64
Summary     : Fortran support
URL         : http://gcc.gnu.org
License     : GPLv3+ and GPLv3+ with exceptions and GPLv2+ with exceptions and
            : LGPLv2+ and BSD
Description : The gcc-gfortran package provides support for compiling Fortran
            : programs with the GNU Compiler Collection.
 
[ian@attic-f21 ~]$ rpm -qi gcc-gfortran</strong>
Name        : gcc-gfortran
Version     : 4.9.2
Release     : 6.fc21
Architecture: x86_64
Install Date: Mon 27 Jul 2015 09:36:14 PM EDT
Group       : Development/Languages
Size        : 19126083
License     : GPLv3+ and GPLv3+ with exceptions and GPLv2+ with exceptions and LGPLv2+ and BSD
Signature   : RSA/SHA256, Fri 13 Feb 2015 09:02:15 PM EST, Key ID 89ad4e8795a43f54
Source RPM  : gcc-4.9.2-6.fc21.src.rpm
Build Date  : Thu 12 Feb 2015 07:40:58 AM EST
Build Host  : buildhw-08.phx2.fedoraproject.org
Relocations : (not relocatable)
Packager    : Fedora Project
Vendor      : Fedora Project
URL         : http://gcc.gnu.org
Summary     : Fortran support
Description :
The gcc-gfortran package provides support for compiling Fortran
programs with the GNU Compiler Collection.
```
更广泛的列表显示了一些可与RPM包关联的标记。您会注意到rpm和yum以略微不同的格式显示略有不同的信息。在本教程中，我们将坚持使用标准命令选项提供的基本输出。如果要使用rpm --queryformat选项来构建自定义查询输出，请参见手册页。如果您想了解rpm版本支持的所有标记，请尝试运行rpm --querytags。

如图所示，yum将列出已安装和可用的包。我们安装了x86_64（64位）版本，但也有i686（32位）版本。您还可以使用它来列出具有可用更新的包和具有其他特征的包，例如过时或最近添加到存储库。您甚至可以使用yum搜索包。在，您看到texmacs包未安装，但可从fedora存储库中获得。如果你搜索“texmacs”，你会看到四个提到它的软件包。您可以轻松了解找到TeXmacs *软件包的原因。使用yum info pydot找出为什么还提到了pydot包。
```bash
[ian@attic-f21 ~]$ yum list texmacs</strong>
Loaded plugins: langpacks
Available Packages
TeXmacs.x86_64                      1.0.7.19-4.fc20                       fedora
[ian@attic-f21 ~]$ yum search texmacs</strong>
Loaded plugins: langpacks
============================= N/S matched: texmacs =============================
TeXmacs-devel.i686 : Development files for TeXmacs
TeXmacs-devel.x86_64 : Development files for TeXmacs
sympy-texmacs.noarch : TeXmacs integration for sympy
texmacs-fedora-fonts.noarch : Fonts for TeXmacs
TeXmacs.x86_64 : Structured WYSIWYG scientific text editor
 
  Name and summary matches only, use "search all" for everything.
```
对于其余的查询示例，我们将主要使用rpm，因为它具有更广泛的选项集。 许多示例也可以使用yum完成，而yum具有一些不在基本rpm选项中的功能。 有关详细信息，请参见手册页。

### rpm包中的文件
您经常想知道包中的内容或特定文件来自哪个包。 要列出gcc-gfortran包中的文件，请使用-ql选项，如下所示。 这个包中有很多文件，所以我们只显示了部分输出。
```bash
[ian@attic-f21 ~]$ rpm -ql gcc-gfortran</strong>
/usr/bin/f95
/usr/bin/gfortran
/usr/lib/gcc
/usr/lib/gcc/x86_64-redhat-linux
/usr/lib/gcc/x86_64-redhat-linux/4.9.2
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/32
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/32/libcaf_single.a
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/32/libgfortran.a
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/32/libgfortran.so
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/32/libgfortranbegin.a
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib.f90
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib.h
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib.mod
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib_kinds.mod
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/libcaf_single.a
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/libgfortran.so
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/libgfortran.spec
/usr/lib/gcc/x86_64-redhat-linux/4.9.2/libgfortranbegin.a
/usr/libexec/gcc
/usr/libexec/gcc/x86_64-redhat-linux
/usr/libexec/gcc/x86_64-redhat-linux/4.9.2
/usr/libexec/gcc/x86_64-redhat-linux/4.9.2/f951
/usr/share/doc/gcc-gfortran
/usr/share/doc/gcc-gfortran/ChangeLog-2002.bz2
/usr/share/doc/gcc-gfortran/ChangeLog-2002.libgfortran.bz2
...
usr/share/doc/gcc-gfortran/ChangeLog.bz2
/usr/share/doc/gcc-gfortran/ChangeLog.libgfortran.bz2
/usr/share/doc/gcc-gfortran/ChangeLog.ptr.bz2
/usr/share/info/gfortran.info.gz
/usr/share/man/man1/gfortran.1.gz
```
您可以通过向查询添加-c选项来将列出的文件限制为仅配置文件。 同样，-d选项将显示限制为仅文档文件。

### 查询包文件
上面的包命令在RPM数据库中查询已安装的包。 如果您刚下载了一个软件包并希望获得相同类型的信息，则可以使用查询中的-p选项（对于软件包文件）以及指定软件包文件名（用于安装软件包）来获取此信息。 显示了我们之前下载的两个vim包。 我们只以root身份运行它，因为这些文件位于root的主目录中。 您可以添加其他查询选项，例如-l列表文件或-i列表信息。
```bash
[ian@attic-f21 ~]$ # Query vim packages</strong>
[ian@attic-f21 ~]$ rpm -qp *.rpm</strong>
vim-common-7.4.475-2.fc21.x86_64
vim-enhanced-7.4.475-2.fc21.x86_64
[ian@attic-f21 ~]$ # Query vim configuration files</strong>
[ian@attic-f21 ~]$ rpm -qpc *.rpm</strong>
/etc/vimrc
/etc/profile.d/vim.csh
/etc/profile.d/vim.sh
```

### 查询所有安装好的软件包
-a选项将查询应用于所有已安装的包。 这可以生成大量输出，因此您通常会将其与一个或多个过滤器结合使用，例如排序以对列表进行排序，或多或少地通过它进行分页，wc以获取包或文件计数，或者grep进行搜索 对于包裹，如果您不确定名称。 显示以下查询：

1. 系统上所有包的排序列表
2. 系统上所有软件包的计数
3. 系统上所有软件包中所有文件的计数
4. 使用RPM安装的所有文档文件的计数
5. 搜索所有包含“fortran”（不区分大小写）的包作为其名称的一部分

```bash
[ian@attic-f21 ~]$ rpm -qa | sort | more</strong>
aaajohan-comfortaa-fonts-2.004-4.fc21.noarch
aalib-libs-1.4.0-0.26.rc5.fc21.x86_64
abattis-cantarell-fonts-0.0.16-2.fc21.noarch
abrt-2.3.0-8.fc21.x86_64
abrt-addon-ccpp-2.3.0-8.fc21.x86_64
abrt-addon-kerneloops-2.3.0-8.fc21.x86_64
abrt-addon-pstoreoops-2.3.0-8.fc21.x86_64
abrt-addon-python-2.3.0-8.fc21.x86_64
abrt-addon-python3-2.3.0-8.fc21.x86_64
abrt-addon-vmcore-2.3.0-8.fc21.x86_64
abrt-addon-xorg-2.3.0-8.fc21.x86_64
abrt-cli-2.3.0-8.fc21.x86_64
abrt-dbus-2.3.0-8.fc21.x86_64
abrt-desktop-2.3.0-8.fc21.x86_64
abrt-gui-2.3.0-8.fc21.x86_64
abrt-gui-libs-2.3.0-8.fc21.x86_64
abrt-java-connector-1.1.0-2.fc21.x86_64
abrt-libs-2.3.0-8.fc21.x86_64
abrt-plugin-bodhi-2.3.0-8.fc21.x86_64
abrt-python-2.3.0-8.fc21.x86_64
abrt-python3-2.3.0-8.fc21.x86_64
abrt-retrace-client-2.3.0-8.fc21.x86_64
abrt-tui-2.3.0-8.fc21.x86_64
--More--
[[ian@attic-f21 ~]$ rpm -qa | wc -l</strong>
1540
[ian@attic-f21 ~]$ rpm -qal | wc -l</strong>
179111
[ian@attic-f21 ~]$ rpm -qad | wc -l</strong>
47711
[ian@attic-f21 ~]$ rpm -qa | grep -i fortran</strong>
gcc-gfortran-4.9.2-6.fc21.x86_64
libgfortran-4.9.2-6.fc21.x86_64
```

使用rpm -qa可以简化多个系统的管理。 如果将已排序的输出重定向到一台计算机上的文件，然后在另一台计算机上执行相同操作，则可以使用diff程序查找差异。

### 那些软件包拥有特定的文件？
鉴于您可以列出包中的所有包和所有文件，您现在可以获得查找哪个包拥有文件所需的所有信息。 但是，rpm命令提供-f（或--file）选项以帮助您找到拥有已安装文件的程序包。 假设您想知道我们之前看到的哪个vim包实际上提供了vim命令。 您需要提供该文件的完整路径。 显示了如何使用which命令获取vim命令的完整路径，以及使用此输出作为rpm -qf命令输入的方便提示。 请注意，围绕`哪个vim`的刻度线是反向刻度。 在Bash shell中使用它的另一种方法是使用$（vim）。

```bash
[ian@attic-f21 ~]$ which vim</strong>
/usr/bin/vim
[ian@attic-f21 ~]$ rpm -qf `which vim`</strong>
vim-enhanced-7.4.475-2.fc21.x86_64
[ian@attic-f21 ~]$ rpm -qf $(which vim)</strong>
vim-enhanced-7.4.475-2.fc21.x86_64
```

### RPM依赖
您之前看到我们尝试移除libquadmath-devel因依赖关系而失败。除文件外，RPM包还可能包含其他包可能依赖的任意功能。

如你所见，这通常没什么问题。如果您需要一次安装多个软件包，其中一些可能依赖于其他软件包，只需使用yum，或者将整个列表提供给rpm -Uvh命令，它将分析依赖关系并按正确的顺序执行安装。

除了尝试安装或擦除包并收到错误消息之外，还有一些方法可以找出包需要或依赖的文件或功能。

rpm命令提供了一个选项，用于查询已安装的软件包或软件包文件，以找出它们依赖或需要的功能。这是--requires选项，可以缩写为-R。显示了gcc-gfortran所需的功能。如果要查询包文件而不是RPM数据库，请添加-p选项并使用完整的RPM文件名。

```bash
[ian@attic-f21 ~]$ rpm -qR gcc-gfortran</strong>
/bin/sh
/bin/sh
/sbin/install-info
/sbin/install-info
gcc = 4.9.2-6.fc21
ld-linux-x86-64.so.2()(64bit)
ld-linux-x86-64.so.2(GLIBC_2.3)(64bit)
libc.so.6()(64bit)
libc.so.6(GLIBC_2.11)(64bit)
libc.so.6(GLIBC_2.14)(64bit)
libc.so.6(GLIBC_2.2.5)(64bit)
libc.so.6(GLIBC_2.3)(64bit)
libc.so.6(GLIBC_2.4)(64bit)
libdl.so.2()(64bit)
libdl.so.2(GLIBC_2.2.5)(64bit)
libgfortran = 4.9.2-6.fc21
libgfortran.so.3()(64bit)
libgmp.so.10()(64bit)
libm.so.6()(64bit)
libmpc.so.3()(64bit)
libmpfr.so.4()(64bit)
libquadmath = 4.9.2-6.fc21
libquadmath-devel = 4.9.2-6.fc21
libz.so.1()(64bit)
rpmlib(CompressedFileNames) <= 3.0.4-1
rpmlib(FileDigests) <= 4.6.0-1
rpmlib(PayloadFilesHavePrefix) <= 4.0-1
rpmlib(PayloadIsXz) <= 5.2-1
rtld(GNU_HASH)
```

将功能与提供它们的软件包相匹配可能有些棘手。 带有deplist选项的yum命令可以在这里提供帮助。 如果您只提供不受版本限制的软件包名称，您可能会获得其他已知版本的列表。 显示如何获取已安装的gcc-gfortran版本的依赖关系列表。

```bash
[ian@attic-f21 ~]$ rpm -q gcc-gfortran</strong>
gcc-gfortran-4.9.2-6.fc21.x86_64
[ian@attic-f21 ~]$ yum deplist $(rpm -q gcc-gfortran)</strong>
Loaded plugins: langpacks
package: gcc-gfortran.x86_64 4.9.2-6.fc21
  dependency: /bin/sh
   provider: bash.x86_64 4.3.39-1.fc21
  dependency: /sbin/install-info
   provider: info.x86_64 5.2-5.fc21
  dependency: gcc = 4.9.2-6.fc21
   provider: gcc.x86_64 4.9.2-6.fc21
  dependency: ld-linux-x86-64.so.2()(64bit)
   provider: glibc.x86_64 2.20-8.fc21
  dependency: ld-linux-x86-64.so.2(GLIBC_2.3)(64bit)
   provider: glibc.x86_64 2.20-8.fc21
  dependency: libc.so.6(GLIBC_2.4)(64bit)
   provider: glibc.x86_64 2.20-8.fc21
  dependency: libdl.so.2()(64bit)
   provider: glibc.x86_64 2.20-8.fc21
  dependency: libdl.so.2(GLIBC_2.2.5)(64bit)
   provider: glibc.x86_64 2.20-8.fc21
  dependency: libgfortran = 4.9.2-6.fc21
   provider: libgfortran.x86_64 4.9.2-6.fc21
   provider: libgfortran.i686 4.9.2-6.fc21
  dependency: libgfortran.so.3()(64bit)
   provider: libgfortran.x86_64 4.9.2-6.fc21
  dependency: libgmp.so.10()(64bit)
   provider: gmp.x86_64 1:6.0.0-9.fc21
  dependency: libm.so.6()(64bit)
   provider: glibc.x86_64 2.20-8.fc21
  dependency: libmpc.so.3()(64bit)
   provider: libmpc.x86_64 1.0.2-3.fc21
  dependency: libmpfr.so.4()(64bit)
   provider: mpfr.x86_64 3.1.2-8.fc21
  dependency: libquadmath = 4.9.2-6.fc21
   provider: libquadmath.x86_64 4.9.2-6.fc21
   provider: libquadmath.i686 4.9.2-6.fc21
  dependency: libquadmath-devel = 4.9.2-6.fc21
   provider: libquadmath-devel.x86_64 4.9.2-6.fc21
   provider: libquadmath-devel.i686 4.9.2-6.fc21
  dependency: libz.so.1()(64bit)
   provider: zlib.x86_64 1.2.8-7.fc21
  dependency: rtld(GNU_HASH)
   provider: glibc.x86_64 2.20-8.fc21
   provider: glibc.i686 2.20-8.fc21
```
此列表还显示了每种功能的可能提供者。 您可以看到，大多数依赖项有多种选择。 例如，libquadmath可能来自libquadmath包的32位或64位版本。 通过过滤器，您可以将此输出减少到包名称列表，如下所示。
```bash
[ian@attic-f21 ~]$ yum deplist $(rpm -q gcc-gfortran) | awk '/provider:/ { print $2 }'|sort|uniq</strong>
bash.x86_64
gcc.x86_64
glibc.i686
glibc.x86_64
gmp.x86_64
info.x86_64
libgfortran.i686
libgfortran.x86_64
libmpc.x86_64
libquadmath-devel.i686
libquadmath-devel.x86_64
libquadmath.i686
libquadmath.x86_64
mpfr.x86_64
zlib.x86_64
```
如果您只需要知道需要安装哪些软件包，则可以始终运行yum install并在提示您接受安装提议之前查看列表。

除了找出程序包所需的功能外，您可能还需要找到哪些程序包提供了一些功能。 您在上面看到了如何找到拥有文件的软件包。 展示了如何使用rpm或yum来查找哪个包提供了ld-linux-x86-64.so.2（GLIBC_2.3）（64位）功能。 除了有关提供该功能的已安装软件包的信息外，YUM还显示了存储库中可用的软件包或版本。 这些是fedora存储库中的原始2.20-5版本以及更新存储库中提供的更新的2.20-8版本。
```shell
[ian@attic-f21 ~]$ rpm -q --whatprovides
'ld-linux-x86-64.so.2(GLIBC_2.3)(64bit)'</strong>
glibc-2.20-8.fc21.x86_64
[ian@attic-f21 ~]$ yum whatprovides 'ld-linux-x86-64.so.2(GLIBC_2.3)(64bit)'</strong>
Loaded plugins: langpacks
glibc-2.20-5.fc21.x86_64 : The GNU libc libraries
Repo        : fedora
Matched from:
Provides    : ld-linux-x86-64.so.2(GLIBC_2.3)(64bit)
 
 
 
glibc-2.20-8.fc21.x86_64 : The GNU libc libraries
Repo        : updates
Matched from:
Provides    : ld-linux-x86-64.so.2(GLIBC_2.3)(64bit)
 
 
 
glibc-2.20-8.fc21.x86_64 : The GNU libc libraries
Repo        : @updates
Matched from:
Provides    : ld-linux-x86-64.so.2(GLIBC_2.3)(64bit)
```

## RPM包完整性
为了确保其完整性，RPM软件包包括摘要，例如MD5或SHA1，并且通常经过数字签名。 经过数字签名的软件包需要公钥才能进行验证。 要检查RPM包文件的完整性，请使用rpm的--checksig（缩写为-K）选项。 您通常会发现为更详细的输出添加-v选项很有用。 显示了vim-enhanced RPM的示例。
```shell
[ian@attic-f21 ~]$ rpm -vK vim-enhanced-7.4.475-2.fc21.x86_64.rpm</strong>
vim-enhanced-7.4.475-2.fc21.x86_64.rpm:
    Header V3 RSA/SHA256 Signature, key ID 95a43f54: OK
    Header SHA1 digest: OK (696e492a4ee7a672cb3851d220de804dce0c9484)
    V3 RSA/SHA256 Signature, key ID 95a43f54: OK
    MD5 digest: OK (6bc225b37f43e7e7075668d04a73b9ea)
```
您可能会得到如下所示的输出行。这意味着您有一个已签名的包，但您的RPM数据库中没有所需的公钥。 不同版本的RPM可能以不同方式呈现验证。
```shell
[ian@attic-f21 ~]$ rpm -K audacity-freeworld-2.1.1-1.fc21.x86_64.rpm</strong> 
audacity-freeworld-2.1.1-1.fc21.x86_64.rpm: RSA sha1 ((MD5) PGP) md5 NOT OK (MISSING KEYS: 
(MD5) PGP#6446d859) 
[ian@attic-f21 ~]$ rpm -vK audacity-freeworld-2.1.1-1.fc21.x86_64.rpm </strong>
audacity-freeworld-2.1.1-1.fc21.x86_64.rpm:
    Header V3 RSA/SHA256 Signature, key ID 6446d859: NOKEY
    Header SHA1 digest: OK (231ac5339a8084ba84a4a25d2a996f5d52434935)
    V3 RSA/SHA256 Signature, key ID 6446d859: NOKEY
    MD5 digest: OK (188d9cc3bfa2ac9b87483e387c8e74b6)
```
在这种情况下，我从rpmfusion存储库下载了audacity软件包，但我没有在我的系统上安装该存储库或其密钥。

如果程序包已签名且您要根据签名验证它，则需要找到相应的签名文件并将其导入RPM数据库。 您应首先下载密钥，然后在使用rpm --import命令导入密钥之前检查其指纹。 有关更多信息，请参见RPM手册页。 您还可以在RPM主页上找到有关已签名二进制文件的更多信息。

## 校验已安装的软件包
与检查rpm的完整性一样，您也可以使用rpm -V检查已安装文件的完整性。 此步骤确保文件自从rpm安装后未被修改。 如图所示，如果包仍然良好，则此命令没有输出，但您可以添加-v选项以获得更详细的输出。
```shell
[ian@attic-f21 ~]$ rpm -V vim-common</strong>
```
让我们成为root并破坏我们的vim-common安装，删除/ usr / bin / xxd并用/ bin / bash替换/usr/share/vim/vim74/syntax/bindzone.vim。 我们再试一次验证。 结果显示在。

```shell
[root@attic-f21 ~]# rpm -qf /usr/bin/xxd /usr/share/vim/vim74/syntax/bindzone.vim</strong>
vim-common-7.4.475-2.fc21.x86_64
vim-common-7.4.475-2.fc21.x86_64
[root@attic-f21 ~]# rm /usr/bin/xxd</strong>
rm: remove regular file ‘/usr/bin/xxd’? y</strong>
[root@attic-f21 ~]# cp /bin/bash /usr/share/vim/vim74/syntax/bindzone.vim</strong>
cp: overwrite ‘/usr/share/vim/vim74/syntax/bindzone.vim’? y</strong>
[root@attic-f21 ~]# rpm -V vim-common</strong>
missing     /usr/bin/xxd
S.5....T.    /usr/share/vim/vim74/syntax/bindzone.vim
```
此输出向我们显示/usr/share/vim/vim74/syntax/bindzone.vim文件无法通过MD5求和，文件大小和mtime测试。 解决问题的一种方法是删除软件包然后重新安装它，但是还有其他软件包依赖于vim-common并且已经安装并且仍然可以。 解决方案是使用rpm的--force选项或yum的重新安装功能强制重新安装它。 显示如何使用yum重新安装，然后验证包现在是否正常并且已删除已删除的文件。
```shell
[root@attic-f21 ~]# yum reinstall vim-common</strong>
Loaded plugins: langpacks
Resolving Dependencies
--> Running transaction check
---> Package vim-common.x86_64 2:7.4.475-2.fc21 will be reinstalled
--> Finished Dependency Resolution
 
Dependencies Resolved
 
================================================================================
 Package           Arch          Version                    Repository     Size
================================================================================
Reinstalling:
 vim-common        x86_64        2:7.4.475-2.fc21           fedora        5.9 M
 
Transaction Summary
================================================================================
Reinstall  1 Package
 
Total download size: 5.9 M
Installed size: 21 M
Is this ok [y/d/N]: y</strong>
Downloading packages:
vim-common-7.4.475-2.fc21.x86_64.rpm                        | 5.9 MB  00:03     
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction (shutdown inhibited)
  Installing : 2:vim-common-7.4.475-2.fc21.x86_64                           1/1 
  Verifying  : 2:vim-common-7.4.475-2.fc21.x86_64                           1/1 
 
Installed:
  vim-common.x86_64 2:7.4.475-2.fc21                                            
 
Complete!
[root@attic-f21 ~]# rpm -V vim-common</strong>
[root@attic-f21 ~]# ls /usr/bin/xxd</strong>
/usr/bin/xxd
```
### 如果你需要更多的力量
通常，包管理系统会使您的包保持有序。 但是，如果您设法删除某个程序包的重要部分的文件 - 并重新安装程序包而不删除不能解决问题 - 那么您可能需要在重新安装之前删除该程序包。 对于这种情况，您可能希望删除现有副本并重新安装它，而无需卸载并重新安装所有依赖它的软件包。 为此，您可以使用rpm命令的--nodeps选项在删除包时绕过依赖项检查。 显示了如果您不小心删除了/ usr / bin / xxd文件（这是vim-common软件包的一部分），如前所述，这可能会如何工作。
```shell
[root@attic-f21 ~]# rm /usr/bin/xxd</strong>
rm: remove regular file ‘/usr/bin/xxd’? y</strong>
[root@attic-f21 ~]# # Oops! we needed that file</strong>
[root@attic-f21 ~]# rpm -Fvh vim-common-7.4.475-2.fc21.x86_64.rpm </strong>
[root@attic-f21 ~]# ls /usr/bin/xxd</strong>
ls: cannot access /usr/bin/xxd: No such file or directory
[root@attic-f21 ~]# # Oh! Freshening the package didn't replace the missing file</strong>
[root@attic-f21 ~]# rpm -e vim-common</strong>
error: Failed dependencies:
    vim-common = 2:7.4.475-2.fc21 is needed by (installed) vim-enhanced-2:7.4.475-2.fc21.x86_64
[root@attic-f21 ~]# # Can't remove vim-common because vim-enhanced needs it</strong>
[root@attic-f21 ~]# rpm -e --nodeps vim-common</strong>
warning: file /usr/bin/xxd: remove failed: No such file or directory
[root@attic-f21 ~]# # Bypassing the dependency check allowed removal</strong>
[root@attic-f21 ~]# # No surprise that /usr/bin/xxd was not found</strong>
[root@attic-f21 ~]# # Update (or install) vim-common again</strong>
[root@attic-f21 ~]# rpm -Uvh vim-common-7.4.475-2.fc21.x86_64.rpm</strong>
Preparing...                          ################################# [100%]
Updating / installing...
   1:vim-common-2:7.4.475-2.fc21      ################################# [100%]
[root@attic-f21 ~]# ls /usr/bin/xxd</strong>
/usr/bin/xxd
[root@attic-f21 ~]# # And /usr/bin/xxd is back</strong>
```
因此，如果发生事故并且普通更新过程失败，您现在可以使用一些方法来更新或修复。 请注意，您还可以在安装RPM时绕过依赖项检查，但这通常不是一个好主意。

## 从源下载RPM包
虽然yum会自动从存储库中检索软件包，但您可能需要下载RPM并保存它们，可能是为了将它们安装在非联网系统上，或者检查它们的内容，或者出于其他原因。 您可以使用yumdownloader命令执行此操作，如图所示。 在我们的例子中，已经安装了gcc-gfortran.x86_64包，因此没有其他包可供下载。
```shell
[ian@attic-f21 ~]$ yumdownloader --resolve gcc-gfortran.x86_64</strong>
Loaded plugins: langpacks
--> Running transaction check
---> Package gcc-gfortran.x86_64 0:4.9.2-6.fc21 will be reinstalled
--> Finished Dependency Resolution
gcc-gfortran-4.9.2-6.fc21.x86_64.rpm 
```
yumdownloader的--resolve选项也会导致下载其他必需的包。 为了说明这一点，我们还会在下载gcc-gfortran时显示使用--resolve选项下载的文件。 请注意，我们未指定体系结构（x86_64或i686），因此默认下载适用于i686版本。
```shell
[ian@attic-f21 ~]$ yumdownloader --resolve gcc-gfortran</strong>
Loaded plugins: langpacks
updates/21/x86_64/metalink                                 |  14 kB  00:00     
--> Running transaction check
---> Package gcc-gfortran.i686 0:4.9.2-6.fc21 will be installed
--> Processing Dependency: libz.so.1(ZLIB_1.2.3.3) for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libz.so.1 for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libmpfr.so.4 for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libmpc.so.3 for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libm.so.6 for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libgmp.so.10 for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libgfortran.so.3 for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libdl.so.2(GLIBC_2.1) for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libdl.so.2(GLIBC_2.0) for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libdl.so.2 for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libc.so.6(GLIBC_2.4) for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: ld-linux.so.2(GLIBC_2.3) for package: gcc-gfortran-4.9.2-6.fc21.i686
--> Processing Dependency: ld-linux.so.2 for package: gcc-gfortran-4.9.2-6.fc21.i686
---> Package gcc-gfortran.x86_64 0:4.9.2-6.fc21 will be reinstalled
--> Running transaction check
---> Package glibc.i686 0:2.20-8.fc21 will be installed
--> Processing Dependency: libfreebl3.so(NSSRAWHASH_3.12.3) for package: glibc-2.20-8.fc21.i686
--> Processing Dependency: libfreebl3.so for package: glibc-2.20-8.fc21.i686
---> Package gmp.i686 1:6.0.0-9.fc21 will be installed
--> Processing Dependency: libstdc++.so.6(GLIBCXX_3.4.11) for package: 1:gmp-6.0.0-9.fc21.i686
--> Processing Dependency: libstdc++.so.6(GLIBCXX_3.4) for package: 1:gmp-6.0.0-9.fc21.i686
--> Processing Dependency: libstdc++.so.6(CXXABI_1.3) for package: 1:gmp-6.0.0-9.fc21.i686
--> Processing Dependency: libstdc++.so.6 for package: 1:gmp-6.0.0-9.fc21.i686
--> Processing Dependency: libgcc_s.so.1(GCC_3.0) for package: 1:gmp-6.0.0-9.fc21.i686
--> Processing Dependency: libgcc_s.so.1 for package: 1:gmp-6.0.0-9.fc21.i686
---> Package libgfortran.i686 0:4.9.2-6.fc21 will be installed
--> Processing Dependency: libquadmath.so.0(QUADMATH_1.0) for package: libgfortran-4.9.2-6.fc21.i686
--> Processing Dependency: libquadmath.so.0 for package: libgfortran-4.9.2-6.fc21.i686
---> Package libmpc.i686 0:1.0.2-3.fc21 will be installed
---> Package mpfr.i686 0:3.1.2-8.fc21 will be installed
---> Package zlib.i686 0:1.2.8-7.fc21 will be installed
--> Running transaction check
---> Package libgcc.i686 0:4.9.2-6.fc21 will be installed
---> Package libquadmath.i686 0:4.9.2-6.fc21 will be installed
---> Package libstdc++.i686 0:4.9.2-6.fc21 will be installed
---> Package nss-softokn-freebl.i686 0:3.19.2-1.0.fc21 will be installed
--> Finished Dependency Resolution
(1/12): gcc-gfortran-4.9.2-6.fc21.i686.rpm                 | 7.5 MB  00:04     
(2/12): glibc-2.20-8.fc21.i686.rpm                         | 4.1 MB  00:02     
(3/12): gmp-6.0.0-9.fc21.i686.rpm                          | 420 kB  00:01     
(4/12): libgcc-4.9.2-6.fc21.i686.rpm                       |  97 kB  00:00     
(5/12): libgfortran-4.9.2-6.fc21.i686.rpm                  | 270 kB  00:00     
(6/12): gcc-gfortran-4.9.2-6.fc21.x86_64.rpm               | 7.7 MB  00:09     
(7/12): libmpc-1.0.2-3.fc21.i686.rpm                       |  56 kB  00:01     
(8/12): libquadmath-4.9.2-6.fc21.i686.rpm                  | 243 kB  00:00     
(9/12): mpfr-3.1.2-8.fc21.i686.rpm                         | 211 kB  00:00     
(10/12): libstdc++-4.9.2-6.fc21.i686.rpm                   | 314 kB  00:00     
(11/12): nss-softokn-freebl-3.19.2-1.0.fc21.i686.rpm       | 195 kB  00:00     
(12/12): zlib-1.2.8-7.fc21.i686.rpm                        |  97 kB  00:00
```

## 使用rpm2cpio
如果您下载RPM并需要检查其内容而不是安装它，则可以使用rpm2cpiocommand将内容转换为cpio存档，然后通过cpio命令对其进行过滤，以提取单个文件或包中的所有文件。 显示了如何为gcc-gfortran包执行此操作，然后显示一些已解压缩的文件（和目录）。 有关这些命令的其他详细信息，请参见rpm2cpio和cpio的手册页。
```shell
[[ian@attic-f21 ~]$ mkdir gcc-gfortran</strong>
[ian@attic-f21 ~]$ cd gcc-gfortran</strong>
[ian@attic-f21 gcc-gfortran]$ rpm2cpio ../gcc-gfortran-4.9.2-6.fc21.x86_64.rpm | cpio -idv</strong>
./usr/bin/f95
./usr/bin/gfortran
./usr/lib/gcc
./usr/lib/gcc/x86_64-redhat-linux
./usr/lib/gcc/x86_64-redhat-linux/4.9.2
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/32
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/32/libcaf_single.a
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/32/libgfortran.a
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/32/libgfortran.so
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/32/libgfortranbegin.a
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib.f90
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib.h
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib.mod
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib_kinds.mod
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/libcaf_single.a
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/libgfortran.so
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/libgfortran.spec
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/libgfortranbegin.a
./usr/libexec/gcc
./usr/libexec/gcc/x86_64-redhat-linux
./usr/libexec/gcc/x86_64-redhat-linux/4.9.2
./usr/libexec/gcc/x86_64-redhat-linux/4.9.2/f951
./usr/share/doc/gcc-gfortran
./usr/share/doc/gcc-gfortran/ChangeLog-2002.bz2
./usr/share/doc/gcc-gfortran/ChangeLog-2002.libgfortran.bz2
...
./usr/share/doc/gcc-gfortran/ChangeLog.bz2
./usr/share/doc/gcc-gfortran/ChangeLog.libgfortran.bz2
./usr/share/doc/gcc-gfortran/ChangeLog.ptr.bz2
./usr/share/info/gfortran.info.gz
./usr/share/man/man1/gfortran.1.gz
37373 blocks
[ian@attic-f21 gcc-gfortran]$ find . | head</strong>
.
./usr
./usr/lib
./usr/lib/gcc
./usr/lib/gcc/x86_64-redhat-linux
./usr/lib/gcc/x86_64-redhat-linux/4.9.2
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/libcaf_single.a
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib.h
./usr/lib/gcc/x86_64-redhat-linux/4.9.2/finclude/omp_lib.mod
```

## 查找RPM包
我们之前看到YUM提供搜索功能，搜索描述和包名称。 如果您需要找到包含您尚未安装的程序的软件包，还有其他一些方法：

- 您可以猜出包含它的包可以在不安装的情况下下载包。 一旦你有了包裹，你可以询问它。
- 可以通过英特网查找
- 你可以使用command-not-found功能

如果您无法通过系统工具找到特定的RPM，那么用于查找RPM的良好Internet资源就是Rpmfind.Net服务器。

### command not found
当Bash shell搜索命令但找不到它时，shell会搜索名为command_not_found_handle的shell函数。 如果command_not_found_handle函数存在，则使用原始命令和原始参数作为其参数调用它，函数的退出状态将成为shell的退出状态。 如果未定义该函数，则shell会输出错误消息并返回退出状态127.该函数通常在系统/etc/bash.bashrc文件或其他配置文件中设置，例如/etc/profile.d/PackageKit.SH。 显示我们如何搜索命令未找到的功能。 如果它尚未安装在您的系统上，您现在知道如何安装它。
```shell
[ian@attic-f21 ~]$ yum search command-not-found</strong>
Loaded plugins: langpacks
======================= N/S matched: command-not-found ========================
PackageKit-command-not-found.x86_64 : Ask the user to install command line
                                    : programs automatically
 
  Name and summary matches only, use "search all" for everything.
```
显示安装PackageKit-command-not-found后如何定义函数句柄。 如果函数无法执行搜索，则它会模仿标准系统行为并返回127。
```shell
[ian@attic-f21 ~]$ type command_not_found_handle</strong>
command_not_found_handle is a function
command_not_found_handle () 
{ 
    local runcnf=1;
    local retval=127;
    [[ $- =~ i ]] || runcnf=0;
    [ ! -S /var/run/dbus/system_bus_socket ] && runcnf=0;
    [ ! -x /usr/libexec/packagekitd ] && runcnf=0;
    if [ $runcnf -eq 1 ]; then
        /usr/libexec/pk-command-not-found "$@";
        retval=$?;
    else
        echo "bash: $1: command not found";
    fi;
    return $retval
}
```
在本教程的开头，我们向您展示了gfortran --help的两个不同输出。 第一个显示禁用command_not_found_handle的响应，第二个启用它。 回去看看差异。

## 其他工具
除了yum和rpm之外，您的发行版还可以提供其他工具来从存储库安装软件包或更新整个系统。 这些工具可以是图形或命令行或两者。 一些例子包括：

- YaST (SUSE)
- up2date (Red Hat)
- Mandrake Software Management (Mandriva)

通常，这些工具将以自动或半自动方式处理多个包更新。 它们还可以提供显示存储库内容或搜索包的功能。 有关更多详细信息，请参阅发行版的文档。

### dnf
使用Fedora 22，Red Hat用一个名为dnf的新工具（用于dandified yum）取代了古老的yum。 自从Fedora 18作为技术预览以来，它一直在Fedora包中。 根据项目页面：启动DNF项目的原因是因为Yum最大的三个陷阱：API缺少文档，破坏的依赖性解决算法和无法重构内部函数。 最后提到的问题与缺乏文件有关。大多数命令行界面与yum类似或相同，并且工具也类似或具有等价物。 在使用dnf的系统上使用yum命令通常会起作用，虽然警告yum命令已被弃用，你应该使用dnf。虽然dnf还不是LPI目标的一部分，但您应该知道它是yum的替代品。

## PackageKit
如果不提及PackageKit，就不会讨论软件包安装，而PackageKit是一个旨在简化软件安装和更新的系统。 目的是统一不同发行版中使用的所有软件图形工具。 PackageKit使用系统激活的守护程序，这意味着只有在需要时才会激活守护程序。 PackageKit有Gnome（gnome-packagekit）和KDE KPackageKit的版本。 上面描述的command-not-found手柄也是PackageKit的一部分。 它包括用于从控制台执行包管理功能的命令pkcon，以及用于监视包工具包活动的pkmon。 它还包括用于添加软件包或更新系统的图形工具。 显示了Gnome PackageKit（/ usr / bin / gpk-application）图形界面的示例。
![此处输入图片的描述][1]
在撰写本文时，最近的Fedora版本已经用一个名为gnome-software的新软件包取代了PackageKit。 该项目声称：

这个名为gnome-software的新工具从一开始就设计用于安装应用程序。 它将向应用程序提供与用户相关的信息（图标，屏幕截图，评论，描述，评级等），而不是与打包者相关的信息（依赖关系，包大小，文件列表......）。
这不适用于所有程序包，仅检查特定计划的更新，并且需要不必要的重新启动。 有关为何如此设计的说明，请参阅错误1064717。 您可以安装gnome-packagekit-installer和gnome-packagekit-updater包以获取PackageKit功能。

RPM和YUM包管理系统还有很多其他功能。

  [1]: https://www.ibm.com/developerworks/library/l-lpic1-102-5/gpk.jpg
